# Proteção de Segurança - Chicas Eventos
# Arquivo .htaccess para proteção adicional do sistema

# Proteger arquivo de gerenciamento de contas
<Files "gerenciar-contas.html">
    # Requer autenticação básica
    AuthType Basic
    AuthName "Acesso Restrito - Chicas Eventos"
    AuthUserFile /path/to/.htpasswd
    Require valid-user
    
    # Bloquear acesso direto
    Order Deny,Allow
    Deny from all
    Allow from 127.0.0.1
    Allow from localhost
</Files>

# Proteger arquivos de configuração
<Files "security-config.js">
    Order Deny,Allow
    Deny from all
</Files>

# Proteger arquivos de teste
<Files "test-*.html">
    Order Deny,Allow
    Deny from all
    Allow from 127.0.0.1
    Allow from localhost
</Files>

# Bloquear acesso a arquivos sensíveis
<FilesMatch "\.(js|css|json)$">
    # Permitir apenas arquivos necessários
    <If "%{REQUEST_URI} !~ /^(js|css)/">
        Order Deny,Allow
        Deny from all
    </If>
</FilesMatch>

# Configurações de segurança gerais
ServerSignature Off
Options -Indexes

# Headers de segurança
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';"
</IfModule>

# Bloquear bots e crawlers
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTP_USER_AGENT} (bot|crawler|spider|scraper) [NC]
    RewriteRule ^gerenciar-contas\.html$ - [F,L]
</IfModule>

# Log de tentativas de acesso
<IfModule mod_log_config.c>
    LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-agent}i\"" security
    CustomLog logs/security.log security
</IfModule>
