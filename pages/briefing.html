<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Briefing — Chicas Eventos</title>
  <link rel="icon" href="../assets/public/img/favicon.png">
  <link rel="stylesheet" href="../assets/css/style.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { prefix: 'tw-', corePlugins: { preflight: false } };
  </script>
</head>
<body class="tw-min-h-screen tw-flex tw-flex-col tw-bg-[#f7faf9]">

  <!-- HEADER -->
  <header class="site-header">
    <div class="container nav">
      <a class="brand" href="../index.html"><span class="logo"></span><strong>Chicas Eventos</strong></a>
      <button class="hamb md:tw-hidden" id="hamb" aria-label="Abrir menu">☰</button>
      <nav class="tw-hidden md:tw-block">
        <ul class="nav-list">
          <li><a href="../index.html#servicos">Serviços</a></li>
          <li><a href="portfolio.html">Portfólio</a></li>
          <li><a href="sobre.html">Sobre</a></li>
          <li><a class="nav-cta" href="briefing.html">Fazer orçamento</a></li>
        </ul>
      </nav>
    </div>
    <ul id="menuMobile" class="nav-mobile" style="display:none">
      <li><a href="../index.html#servicos">Serviços</a></li>
      <li><a href="portfolio.html">Portfólio</a></li>
      <li><a href="sobre.html">Sobre</a></li>
      <li><a class="nav-cta" href="briefing.html">Fazer orçamento</a></li>
    </ul>
  </header>

  <!-- CONTEÚDO -->
  <main class="tw-flex-1 tw-py-10">
    <div class="tw-container tw-mx-auto tw-max-w-3xl tw-px-4">
      <section class="tw-p-6 md:tw-p-10 tw-rounded-[28px] tw-border tw-border-slate-200 tw-shadow-2xl tw-bg-white/85 tw-backdrop-blur-sm">
        <div class="tw-text-center tw-space-y-4">
          <h1 class="tw-text-3xl md:tw-text-4xl tw-font-extrabold tw-text-slate-900">Briefing</h1>
          <p class="tw-text-slate-600">Fill it out quickly and we’ll return with your quote. If you prefer, contact us directly on WhatsApp.</p>
          <a href="https://wa.me/5599999999999?text=Hello!%20I%E2%80%99d%20like%20a%20quote%20and%20preferred%20to%20contact%20you%20directly%20here." target="_blank" rel="noopener" class="tw-inline-flex tw-items-center tw-justify-center tw-px-4 tw-py-2 tw-rounded-xl tw-font-semibold tw-shadow tw-bg-emerald-700 tw-text-white hover:tw-opacity-95">Contact on WhatsApp now</a>
        </div>

        <form id="briefingForm" class="tw-mt-8 tw-space-y-6">
          <div>
            <label class="tw-text-sm tw-font-semibold tw-text-slate-700">Full Name</label>
            <input name="nome" required class="tw-w-full tw-px-4 tw-py-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-text-slate-900 placeholder:tw-text-slate-400 focus:tw-outline-none focus:tw-border-emerald-400" placeholder="Your full name">
          </div>
          <div>
            <label class="tw-text-sm tw-font-semibold tw-text-slate-700">WhatsApp</label>
            <input id="whatsapp" name="whatsapp" type="tel" required class="tw-w-full tw-px-4 tw-py-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-text-slate-900 placeholder:tw-text-slate-400 focus:tw-outline-none focus:tw-border-emerald-400" placeholder="(00) 00000-0000">
          </div>
          <div>
            <label class="tw-text-sm tw-font-semibold tw-text-slate-700">E-mail</label>
            <input type="email" name="email" class="tw-w-full tw-px-4 tw-py-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-text-slate-900 placeholder:tw-text-slate-400 focus:tw-outline-none focus:tw-border-emerald-400" placeholder="you@example.com">
          </div>
          <div>
            <label class="tw-text-sm tw-font-semibold tw-text-slate-700">Event Date</label>
            <input type="date" name="data_evento" required class="tw-w-full tw-px-4 tw-py-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-text-slate-900 focus:tw-outline-none focus:tw-border-emerald-400">
          </div>
          <div>
            <label class="tw-text-sm tw-font-semibold tw-text-slate-700">Event Location</label>
            <input type="text" name="local_evento" required class="tw-w-full tw-px-4 tw-py-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-text-slate-900 placeholder:tw-text-slate-400 focus:tw-outline-none focus:tw-border-emerald-400" placeholder="Address/Neighborhood/City">
          </div>
          <div>
            <label class="tw-text-sm tw-font-semibold tw-text-slate-700">Number of Guests</label>
            <input type="number" name="convidados" min="1" required class="tw-w-full tw-px-4 tw-py-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-text-slate-900 placeholder:tw-text-slate-400 focus:tw-outline-none focus:tw-border-emerald-400" placeholder="e.g., 100">
          </div>
          <div>
            <span class="tw-text-sm tw-font-semibold tw-text-slate-700">Service of Interest</span>
            <div class="tw-mt-2 tw-flex tw-flex-wrap tw-gap-4">
              <label class="tw-inline-flex tw-items-center tw-gap-2"><input type="checkbox" name="servicos" value="Buffet" class="tw-rounded tw-border-slate-300 tw-text-emerald-600 focus:tw-ring-emerald-500"><span>Buffet</span></label>
              <label class="tw-inline-flex tw-items-center tw-gap-2"><input type="checkbox" name="servicos" value="Audiovisual" class="tw-rounded tw-border-slate-300 tw-text-emerald-600 focus:tw-ring-emerald-500"><span>Audiovisual</span></label>
              <label class="tw-inline-flex tw-items-center tw-gap-2"><input type="checkbox" name="servicos" value="Ceremonial" class="tw-rounded tw-border-slate-300 tw-text-emerald-600 focus:tw-ring-emerald-500"><span>Ceremonial</span></label>
              <label class="tw-inline-flex tw-items-center tw-gap-2"><input type="checkbox" name="servicos" value="HR" class="tw-rounded tw-border-slate-300 tw-text-emerald-600 focus:tw-ring-emerald-500"><span>HR</span></label>
            </div>
          </div>
          <div>
            <label class="tw-text-sm tw-font-semibold tw-text-slate-700">Event Description</label>
            <textarea name="descricao" rows="4" class="tw-w-full tw-px-4 tw-py-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-text-slate-900 placeholder:tw-text-slate-400 focus:tw-outline-none focus:tw-border-emerald-400" placeholder="Describe your event"></textarea>
          </div>
          <div class="tw-text-center">
            <button type="submit" id="submitBtn" class="tw-inline-flex tw-items-center tw-justify-center tw-px-6 tw-py-3 tw-rounded-xl tw-font-semibold tw-shadow tw-bg-emerald-700 tw-text-white hover:tw-opacity-95">Submit Briefing</button>
          </div>
        </form>

        <div id="successBox" class="tw-hidden tw-text-center tw-space-y-4 tw-mt-8">
          <h3 class="tw-text-2xl tw-font-extrabold tw-text-emerald-700">Briefing sent!</h3>
          <div class="tw-flex tw-justify-center tw-gap-4">
            <a href="https://wa.me/5599999999999?text=Hello!%20I%E2%80%99d%20like%20a%20quote%20and%20preferred%20to%20contact%20you%20directly%20here." target="_blank" rel="noopener" class="tw-inline-flex tw-items-center tw-justify-center tw-px-4 tw-py-2 tw-rounded-xl tw-font-semibold tw-shadow tw-bg-emerald-700 tw-text-white hover:tw-opacity-95">Contact on WhatsApp</a>
            <a href="portfolio.html" class="tw-inline-flex tw-items-center tw-justify-center tw-px-4 tw-py-2 tw-rounded-xl tw-font-semibold tw-shadow tw-bg-white tw-text-emerald-700 tw-border tw-border-emerald-700 hover:tw-bg-emerald-50">View Portfolio</a>
          </div>
        </div>

      </section>
    </div>
  </main>

  <script>
    const hamb = document.getElementById('hamb');
    const menuMobile = document.getElementById('menuMobile');
    hamb?.addEventListener('click', () => {
      const show = menuMobile.style.display !== 'block';
      menuMobile.style.display = show ? 'block' : 'none';
    });
    menuMobile?.querySelectorAll('a').forEach(a => a.addEventListener('click', () => {
      menuMobile.style.display = 'none';
    }));
  </script>

  <script>
    const WEBHOOK_URL = 'https://script.google.com/macros/s/AKfycbzbfANL3UPIMbceYdLhNYN7a6-4F3ZJLbDrczqJlGKrha1yyxb9THnYFC0lrymYYKwF/exec';
    const EXTRA_NOTIFY = 'rj.justke@gmail.com';

    const form = document.getElementById('briefingForm');
    const submitBtn = document.getElementById('submitBtn');
    const successBox = document.getElementById('successBox');

    function formToObject(){
      const fd = new FormData(form);
      return {
        nome: fd.get('nome') || '',
        whatsapp: fd.get('whatsapp') || '',
        email: fd.get('email') || '',
        data_evento: fd.get('data_evento') || '',
        local_evento: fd.get('local_evento') || '',
        convidados: fd.get('convidados') || '',
        servicos: Array.from(form.querySelectorAll('input[name="servicos"]:checked')).map(c=>c.value),
        descricao: fd.get('descricao') || '',
        timestamp: new Date().toISOString(),
        ...(EXTRA_NOTIFY ? { notify_email: EXTRA_NOTIFY } : {})
      };
    }

    async function sendJSON(url, data, mode='cors'){
      if (mode === 'no-cors'){
        const fd = new FormData();
        fd.append('payload', JSON.stringify(data));
        return fetch(url, { method:'POST', mode:'no-cors', body: fd });
      }
      return fetch(url, {
        method:'POST',
        headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify(data),
        mode:'cors'
      });
    }

    function postViaHiddenForm(url, payloadObj){
      const f = document.createElement('form');
      f.action = url; f.method = 'POST'; f.target = '_hidden_iframe'; f.style.display='none';
      const input = document.createElement('input');
      input.type = 'hidden'; input.name = 'payload'; input.value = JSON.stringify(payloadObj);
      f.appendChild(input);
      let iframe = document.getElementById('_hidden_iframe');
      if (!iframe){ iframe = document.createElement('iframe'); iframe.name='_hidden_iframe'; iframe.id='_hidden_iframe'; iframe.style.display='none'; document.body.appendChild(iframe); }
      document.body.appendChild(f); f.submit();
    }

    function setLoading(isLoading){
      submitBtn.disabled = isLoading;
      if(isLoading){
        submitBtn.classList.add('tw-opacity-60','tw-cursor-not-allowed');
        submitBtn.textContent = 'Sending…';
      } else {
        submitBtn.classList.remove('tw-opacity-60','tw-cursor-not-allowed');
        submitBtn.textContent = 'Submit Briefing';
      }
    }

    function showSuccess(){
      form.classList.add('tw-hidden');
      successBox.classList.remove('tw-hidden');
      window.scrollTo({top:0, behavior:'smooth'});
    }

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const services = form.querySelectorAll('input[name="servicos"]:checked');
      if(!services.length){
        alert('Please select at least one service of interest.');
        return;
      }
      const data = formToObject();
      setLoading(true);
      try{
        let res = await sendJSON(WEBHOOK_URL, data, 'cors');
        if(!res.ok){
          await sendJSON(WEBHOOK_URL, data, 'no-cors');
          setLoading(false);
          showSuccess();
          return;
        }
        await res.json().catch(()=>null);
        setLoading(false);
        showSuccess();
      }catch(err){
        try{
          postViaHiddenForm(WEBHOOK_URL, data);
          setLoading(false);
          showSuccess();
        }catch(_){
          setLoading(false);
          alert('Could not send. Check the Web App URL and permissions.');
        }
      }
    });

    const wInput = document.getElementById('whatsapp');
    wInput.addEventListener('input', (e)=>{
      let v = e.target.value.replace(/\D/g, '').slice(0,11);
      v = v.replace(/^(\d{2})(\d)/, '($1) $2');
      v = v.replace(/(\d{5})(\d)/, '$1-$2');
      e.target.value = v;
    });
  </script>

</body>
</html>

