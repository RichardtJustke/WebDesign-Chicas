<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Briefing ‚Äî Chicas Eventos</title>
  <link rel="icon" href="../assets/public/img/favicon.png">

  <!-- CSS da home -->
  <link rel="stylesheet" href="../assets/css/style.css">

  <!-- Tailwind (prefixo tw-) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { prefix: 'tw-', corePlugins: { preflight: false } };
  </script>
</head>

<body class="tw-min-h-screen tw-flex tw-flex-col tw-bg-[#f7faf9]">

  <!-- ===== HEADER ===== -->
  <header class="site-header">
    <div class="container nav">
      <a class="brand" href="/"><span class="logo"></span><strong>Chicas Eventos</strong></a>
      <button class="hamb md:tw-hidden" id="hamb" aria-label="Abrir menu">‚ò∞</button>
      <nav class="tw-hidden md:tw-block">
        <ul class="nav-list">
          <li><a href="/pages/servicos.html">Servi√ßos</a></li>
          <li><a href="/pages/portfolio.html">Portf√≥lio</a></li>
          <li><a href="/pages/sobre.html">Sobre</a></li>
          <li><a class="nav-cta" href="/pages/briefing.html">Fazer or√ßamento</a></li>
        </ul>
      </nav>
    </div>
    <ul id="menuMobile" class="nav-mobile">
      <li><a href="/pages/servicos.html">Servi√ßos</a></li>
      <li><a href="/pages/portfolio.html">Portf√≥lio</a></li>
      <li><a href="/pages/sobre.html">Sobre</a></li>
      <li><a class="nav-cta" href="/pages/briefing.html">Fazer or√ßamento</a></li>
    </ul>
  </header>

  <!-- ===== CONTE√öDO ===== -->
  <main class="tw-flex-1 tw-py-10">
    <div class="tw-container tw-mx-auto tw-max-w-6xl tw-px-4">

      <!-- Bal√£o do formul√°rio -->
      <section class="tw-mx-auto tw-max-w-3xl tw-p-0 tw-rounded-[28px] tw-border tw-border-slate-200 tw-shadow-2xl tw-bg-white/85 tw-backdrop-blur-sm tw-overflow-hidden">
        <!-- Barra de progresso -->
        <div class="tw-relative tw-h-2 tw-bg-slate-100">
          <div id="progressBar"
               class="tw-absolute tw-left-0 tw-top-0 tw-h-full tw-bg-emerald-600 tw-w-[12%] tw-transition-all tw-duration-300"></div>
        </div>

        <div class="tw-p-6 md:tw-p-10">
          <div class="tw-text-center tw-mb-6">
            <span class="tw-text-xs tw-tracking-wide tw-font-semibold tw-text-emerald-700 tw-uppercase">Or√ßamento</span>
            <h1 class="tw-text-3xl md:tw-text-4xl tw-font-extrabold tw-text-slate-900 tw-mt-1">Briefing r√°pido</h1>
            <p class="tw-text-slate-600 tw-mt-2">Leva menos de 2 min. Assim entendemos sua necessidade e preparamos um or√ßamento sob medida.</p>
          </div>

          <form id="briefingForm" class="tw-space-y-10">
            <!-- STEP 1 -->
            <div class="step" data-step="1">
              <h2 class="tw-text-base tw-font-bold tw-text-slate-900 tw-mb-3">1) Seus dados</h2>
              <div class="tw-grid tw-gap-4 md:tw-grid-cols-2">
                <div class="md:tw-col-span-2">
                  <label class="tw-text-sm tw-font-semibold tw-text-slate-700">Nome</label>
                  <input class="tw-w-full tw-px-4 tw-py-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-text-slate-900 placeholder:tw-text-slate-400 focus:tw-outline-none focus:tw-border-emerald-400" name="nome" required placeholder="Seu nome completo">
                </div>
                <div>
                  <label class="tw-text-sm tw-font-semibold tw-text-slate-700">Telefone</label>
                  <input class="tw-w-full tw-px-4 tw-py-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-text-slate-900 placeholder:tw-text-slate-400 focus:tw-outline-none focus:tw-border-emerald-400" name="telefone" required placeholder="(00) 00000-0000">
                </div>
                <div>
                  <label class="tw-text-sm tw-font-semibold tw-text-slate-700">E-mail</label>
                  <input type="email" class="tw-w-full tw-px-4 tw-py-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-text-slate-900 placeholder:tw-text-slate-400 focus:tw-outline-none focus:tw-border-emerald-400" name="email" required placeholder="voce@email.com">
                </div>
              </div>
            </div>

            <!-- STEP 2 -->
            <div class="step" data-step="2">
              <h2 class="tw-text-base tw-font-bold tw-text-slate-900 tw-mb-3">2) Que tipo de evento ser√°?</h2>
              <select class="tw-w-full tw-px-4 tw-py-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-text-slate-900 placeholder:tw-text-slate-400 focus:tw-outline-none focus:tw-border-emerald-400" name="tipo_evento" required>
                <option value="" disabled selected>Selecione‚Ä¶</option>
                <option>Corporativo</option>
                <option>Confer√™ncia / Feira</option>
                <option>Anivers√°rio</option>
                <option>Casamento</option>
                <option>Lan√ßamento de produto</option>
                <option>Outro</option>
              </select>
            </div>

            <!-- STEP 3 -->
            <div class="step" data-step="3">
              <h2 class="tw-text-base tw-font-bold tw-text-slate-900 tw-mb-3">3) Buffet</h2>
              <div class="tw-flex tw-gap-3 tw-flex-wrap tw-mb-3">
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-toggle="buffet" data-value="sim">Preciso de buffet</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-toggle="buffet" data-value="nao">N√£o preciso</button>
              </div>
              <div id="buffetTipos" class="tw-hidden tw-grid tw-gap-3 md:tw-grid-cols-2">
                <label class="tw-text-sm tw-font-semibold tw-text-slate-700 md:tw-col-span-2">Que tipo de buffet?</label>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-multi="tipo_buffet" data-value="Coffee break">Coffee break</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-multi="tipo_buffet" data-value="Coquetel">Coquetel</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-multi="tipo_buffet" data-value="Brunch">Brunch</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-multi="tipo_buffet" data-value="Almo√ßo/Jantar">Almo√ßo/Jantar</button>
              </div>

              <!-- Prefer√™ncias do buffet (opcional) -->
              <div id="buffetCustomWrap" class="tw-hidden tw-mt-4">
                <label class="tw-text-sm tw-font-semibold tw-text-slate-700">Prefer√™ncias do buffet (opcional)</label>
                <textarea class="tw-w-full tw-px-4 tw-py-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-text-slate-900 placeholder:tw-text-slate-400 focus:tw-outline-none focus:tw-border-emerald-400" rows="3" name="buffet_custom" placeholder="Ex.: Coquetel com op√ß√µes sem lactose, incluir sucos naturais..."></textarea>
              </div>
            </div>

            <!-- STEP 4 -->
            <div class="step" data-step="4">
              <h2 class="tw-text-base tw-font-bold tw-text-slate-900 tw-mb-3">4) Cobertura audiovisual</h2>
              <div class="tw-flex tw-gap-3 tw-flex-wrap tw-mb-3">
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-toggle="aud" data-value="sim">Preciso de cobertura</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-toggle="aud" data-value="nao">N√£o preciso</button>
              </div>
              <div id="audTipos" class="tw-hidden tw-grid tw-gap-3 md:tw-grid-cols-3">
                <label class="tw-text-sm tw-font-semibold tw-text-slate-700 md:tw-col-span-3">De que tipo?</label>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-multi="tipo_aud" data-value="Foto">Foto</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-multi="tipo_aud" data-value="V√≠deo">V√≠deo</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-multi="tipo_aud" data-value="Drone">Drone</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-multi="tipo_aud" data-value="Social media (reels/stories)">Social media</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-multi="tipo_aud" data-value="Pacote completo">Pacote completo</button>
              </div>
            </div>

            <!-- STEP 5 -->
            <div class="step" data-step="5">
              <h2 class="tw-text-base tw-font-bold tw-text-slate-900 tw-mb-3">5) Equipe operacional (RH)</h2>
              <div class="tw-flex tw-gap-3 tw-flex-wrap tw-mb-3">
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-toggle="rh" data-value="sim">Preciso de equipe</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-toggle="rh" data-value="nao">N√£o preciso</button>
              </div>
              <div id="rhTipos" class="tw-hidden tw-grid tw-gap-3 md:tw-grid-cols-2">
                <label class="tw-text-sm tw-font-semibold tw-text-slate-700 md:tw-col-span-2">Qual(is) desses?</label>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-multi="tipo_rh" data-value="Gar√ßom">Gar√ßom</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-multi="tipo_rh" data-value="Recepcionista">Recepcionista</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-multi="tipo_rh" data-value="Seguran√ßa">Seguran√ßa</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-multi="tipo_rh" data-value="Apoio/Operacional">Apoio/Operacional</button>
              </div>
            </div>

            <!-- STEP 6 -->
            <div class="step" data-step="6">
              <h2 class="tw-text-base tw-font-bold tw-text-slate-900 tw-mb-3">6) Cerimonial</h2>
              <p class="tw-text-slate-700 tw-mb-3">Nosso cerimonial cuida do planejamento completo, cronograma, fornecedores e execu√ß√£o no dia.</p>
              <div class="tw-flex tw-gap-3 tw-flex-wrap">
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-toggle="cerim" data-value="sim">Quero cerimonial</button>
                <button type="button" class="tw-inline-flex tw-items-center tw-gap-2 tw-px-4 tw-py-2 tw-rounded-full tw-border tw-border-slate-200 tw-bg-white tw-text-slate-800 tw-shadow-sm hover:tw-border-slate-300 tw-transition" data-toggle="cerim" data-value="nao">N√£o preciso</button>
              </div>
              <div class="tw-mt-4">
                <label class="tw-text-sm tw-font-semibold tw-text-slate-700">Observa√ß√µes (opcional)</label>
                <textarea class="tw-w-full tw-px-4 tw-py-3 tw-rounded-xl tw-border tw-border-slate-200 tw-shadow-sm tw-text-slate-900 placeholder:tw-text-slate-400 focus:tw-outline-none focus:tw-border-emerald-400" rows="3" name="obs" placeholder="Datas, hor√°rios, local, estimativa de p√∫blico‚Ä¶"></textarea>
              </div>
            </div>

            <!-- STEP 7 -->
            <div class="step" data-step="7">
              <h2 class="tw-text-base tw-font-bold tw-text-slate-900 tw-mb-1">Resumo</h2>
              <p class="tw-text-slate-600 tw-mb-4">Confira as informa√ß√µes antes de enviar:</p>
              <div id="resume" class="tw-bg-slate-50 tw-border tw-border-slate-200 tw-rounded-xl tw-p-4 tw-text-slate-800"></div>

              <div class="tw-mt-6 tw-text-center tw-text-emerald-700 tw-font-semibold">
                Nossa equipe entrar√° em contato em breve. üí¨
              </div>

              <div class="tw-mt-6 tw-flex tw-justify-center">
                <a href="/pages/portfolio.html" class="tw-inline-flex tw-items-center tw-justify-center tw-px-5 tw-py-3 tw-rounded-xl tw-font-semibold tw-shadow tw-bg-white tw-text-slate-900 tw-border tw-border-slate-200 hover:tw-bg-slate-50">Ver portf√≥lio</a>
              </div>
            </div>

            <!-- Navega√ß√£o -->
            <div class="tw-flex tw-justify-between tw-items-center">
              <button type="button" id="prevBtn"
                class="tw-inline-flex tw-items-center tw-justify-center tw-px-5 tw-py-3 tw-rounded-xl tw-font-semibold tw-shadow tw-bg-white tw-text-slate-900 tw-border tw-border-slate-200 hover:tw-bg-slate-50">‚Üê Voltar</button>
              <div class="tw-flex tw-gap-2">
                <button type="button" id="nextBtn"
                  class="tw-inline-flex tw-items-center tw-justify-center tw-px-5 tw-py-3 tw-rounded-xl tw-font-semibold tw-shadow tw-bg-emerald-700 tw-text-white hover:tw-opacity-95">Pr√≥ximo ‚Üí</button>
                <button type="submit" id="sendBtn"
                  class="tw-hidden tw-inline-flex tw-items-center tw-justify-center tw-px-5 tw-py-3 tw-rounded-xl tw-font-semibold tw-shadow tw-bg-emerald-700 tw-text-white hover:tw-opacity-95">Enviar</button>
              </div>
            </div>
          </form>

          <!-- feedback -->
          <div id="statusBox" class="tw-hidden tw-mt-6 tw-text-center"></div>
        </div>
      </section>
      <!-- /bal√£o -->
    </div>
  </main>

  <!-- ===== FOOTER ===== -->
  <footer class="site-footer tw-mt-10">
    <div class="container footer-wrap">
      <div class="f-col">
        <div class="brand-line">
          <img src="../assets/public/img/favicon.png" alt="" class="f-logo" />
          <span class="f-brand">Chicas Eventos</span>
        </div>
        <p class="f-desc">
          Sabores que marcam momentos especiais! Personalize seu card√°pio e torne
          seu evento inesquec√≠vel com nosso buffet exclusivo.
        </p>
        <div class="f-copy">¬© 2025 ¬∑ Justke Design</div>
      </div>
      <div class="f-col">
        <h4 class="f-title">Navegue pelo site</h4>
        <ul class="f-links">
          <li><a href="/pages/servicos/buffet.html">Buffet</a></li>
          <li><a href="/pages/portfolio.html">Galeria</a></li>
          <li><a href="/pages/sobre.html">Sobre N√≥s</a></li>
          <li><a href="/pages/briefing.html">Contato</a></li>
        </ul>
      </div>
      <div class="f-col">
        <h4 class="f-title">Receba novidades e promo√ß√µes!</h4>
        <p class="f-hint">Fique por dentro das novidades!</p>
        <form class="f-news" onsubmit="event.preventDefault(); alert('Valeu! (plugaremos depois)')">
          <input type="email" placeholder="Endere√ßo de e-mail" required>
          <button aria-label="Enviar"><span class="dot"></span></button>
        </form>
      </div>
    </div>
  </footer>

  <!-- Menu mobile -->
  <script>
    const hamb = document.getElementById('hamb');
    const menuMobile = document.getElementById('menuMobile');
    hamb?.addEventListener('click', () => {
      menuMobile.style.display = menuMobile.style.display === 'block' ? 'none' : 'block';
    });
    menuMobile?.querySelectorAll('a').forEach(a => a.addEventListener('click', () => {
      menuMobile.style.display = 'none';
    }));
  </script>

  <!-- Integra√ß√£o com Apps Script -->
  <script>
    /******** CONFIG ********/
    const COMPANY_NAME   = 'Chicas Eventos';
    const WEBHOOK_URL    = 'https://script.google.com/macros/s/AKfycbyjCqA5RK-G57UUWKPA6NmxBZ4uSjA_nLJ6hLPq-E733l0sc4iD-em-KdHicTwQSPSF/execP_EXEC'; // <= troque
    const NOTIFY_EMAILS  = ['rj.justke@gmail.com'];          // opcional, pode deixar vazio []

    /******** PASSOS/ESTADO ********/
    const steps = Array.from(document.querySelectorAll('.step'));
    const progressBar = document.getElementById('progressBar');
    const nextBtn = document.getElementById('nextBtn');
    const prevBtn = document.getElementById('prevBtn');
    const sendBtn = document.getElementById('sendBtn');
    const form = document.getElementById('briefingForm');
    const resumeEl = document.getElementById('resume');
    const statusBox = document.getElementById('statusBox');

    let current = 0;

    const state = {
      buffet: null, tipo_buffet: new Set(),
      aud: null,   tipo_aud: new Set(),
      rh: null,    tipo_rh: new Set(),
      cerim: null
    };

    /******** UI ********/
    function updateUI(){
      steps.forEach((s,i)=> s.style.display = i===current ? 'block' : 'none');
      const pct = Math.round(((current+1)/steps.length)*100);
      progressBar.style.width = pct + '%';
      prevBtn.disabled = current === 0;
      prevBtn.classList.toggle('tw-opacity-50', prevBtn.disabled);
      const last = current === steps.length-1;
      nextBtn.classList.toggle('tw-hidden', last);
      sendBtn.classList.toggle('tw-hidden', !last);
    }

    nextBtn.addEventListener('click', () => {
      if (current < steps.length-1) current++;
      if (current === steps.length-1) buildResume();
      updateUI(); window.scrollTo({top:0, behavior:'smooth'});
    });

    prevBtn.addEventListener('click', () => {
      if (current > 0) current--;
      updateUI(); window.scrollTo({top:0, behavior:'smooth'});
    });

    const buffetCustomWrap = document.getElementById('buffetCustomWrap');

    /******** CHIPS ********/
    function toggleSingle(group, value){
      document.querySelectorAll(`.tw-inline-flex[data-toggle="${group}"]`).forEach(el=>{
        el.dataset.checked = (el.dataset.value === value) ? "true" : "false";
        if (el.dataset.value === value) {
          el.classList.add('tw-bg-emerald-700','tw-text-white','tw-border-emerald-700');
        } else {
          el.classList.remove('tw-bg-emerald-700','tw-text-white','tw-border-emerald-700');
        }
      });
      state[group] = value;

      if (group==='buffet'){
        document.getElementById('buffetTipos').classList.toggle('tw-hidden', value!=='sim');
        buffetCustomWrap.classList.toggle('tw-hidden', value!=='sim');
        if (value!=='sim') {
          state.tipo_buffet.clear();
          document.querySelector('[name="buffet_custom"]').value = '';
        }
        document.querySelectorAll('[data-multi="tipo_buffet"]').forEach(b=>{
          b.dataset.checked="false";
          b.classList.remove('tw-bg-emerald-700','tw-text-white','tw-border-emerald-700');
        });
      }
      if (group==='aud'){
        document.getElementById('audTipos').classList.toggle('tw-hidden', value!=='sim');
        if (value!=='sim') state.tipo_aud.clear();
        document.querySelectorAll('[data-multi="tipo_aud"]').forEach(b=>{
          b.dataset.checked="false";
          b.classList.remove('tw-bg-emerald-700','tw-text-white','tw-border-emerald-700');
        });
      }
      if (group==='rh'){
        document.getElementById('rhTipos').classList.toggle('tw-hidden', value!=='sim');
        if (value!=='sim') state.tipo_rh.clear();
        document.querySelectorAll('[data-multi="tipo_rh"]').forEach(b=>{
          b.dataset.checked="false";
          b.classList.remove('tw-bg-emerald-700','tw-text-white','tw-border-emerald-700');
        });
      }
    }

    function toggleMulti(group, value, el){
      const set = state[group];
      if (set.has(value)) {
        set.delete(value);
        el.dataset.checked="false";
        el.classList.remove('tw-bg-emerald-700','tw-text-white','tw-border-emerald-700');
      } else {
        set.add(value);
        el.dataset.checked="true";
        el.classList.add('tw-bg-emerald-700','tw-text-white','tw-border-emerald-700');
      }
    }

    document.querySelectorAll('[data-toggle]').forEach(btn=>{
      btn.addEventListener('click', ()=> toggleSingle(btn.dataset.toggle, btn.dataset.value));
    });
    document.querySelectorAll('[data-multi]').forEach(btn=>{
      btn.addEventListener('click', ()=> toggleMulti(btn.dataset.multi, btn.dataset.value, btn));
    });

    /******** RESUMO ********/
    function buildResume(){
      const fd = new FormData(form);
      const list = set => set.size ? Array.from(set).join(', ') : '‚Äî';
      resumeEl.innerHTML = `
        <div class="tw-grid tw-gap-3">
          <div><span class="tw-font-semibold">Nome:</span> ${fd.get('nome')||'‚Äî'}</div>
          <div><span class="tw-font-semibold">Telefone:</span> ${fd.get('telefone')||'‚Äî'}</div>
          <div><span class="tw-font-semibold">E-mail:</span> ${fd.get('email')||'‚Äî'}</div>
          <div><span class="tw-font-semibold">Tipo de evento:</span> ${fd.get('tipo_evento')||'‚Äî'}</div>
          <hr class="tw-my-2">
          <div><span class="tw-font-semibold">Buffet:</span> ${state.buffet||'‚Äî'}</div>
          <div><span class="tw-font-semibold">Tipos de buffet:</span> ${list(state.tipo_buffet)}</div>
          <div><span class="tw-font-semibold">Prefer√™ncias do buffet:</span> ${fd.get('buffet_custom')||'‚Äî'}</div>
          <div><span class="tw-font-semibold">Audiovisual:</span> ${state.aud||'‚Äî'}</div>
          <div><span class="tw-font-semibold">Tipos de audiovisual:</span> ${list(state.tipo_aud)}</div>
          <div><span class="tw-font-semibold">RH:</span> ${state.rh||'‚Äî'}</div>
          <div><span class="tw-font-semibold">Cargos solicitados:</span> ${list(state.tipo_rh)}</div>
          <div><span class="tw-font-semibold">Cerimonial:</span> ${state.cerim||'‚Äî'}</div>
          <div><span class="tw-font-semibold">Observa√ß√µes:</span> ${fd.get('obs')||'‚Äî'}</div>
        </div>`;
    }

    function formToObject(){
      const fd = new FormData(form);
      const obj = Object.fromEntries(fd.entries());
      obj.tipo_buffet = Array.from(state.tipo_buffet);
      obj.tipo_aud    = Array.from(state.tipo_aud);
      obj.tipo_rh     = Array.from(state.tipo_rh);
      obj.buffet      = state.buffet;
      obj.aud         = state.aud;
      obj.rh          = state.rh;
      obj.cerim       = state.cerim;
      obj.timestamp   = new Date().toISOString();
      if (NOTIFY_EMAILS?.length) obj.notify_email = NOTIFY_EMAILS; // opcional
      return obj;
    }

    function buildSummaryText(data){
      const j = (a) => Array.isArray(a) && a.length ? a.join(', ') : '‚Äî';
      const get = (k) => data[k] || '‚Äî';
      let t  = `${COMPANY_NAME} ‚Äî Briefing r√°pido\n`;
      t += `Data/Hora: ${new Date().toLocaleString()}\n`;
      t += `----------------------------------------\n`;
      t += `Nome: ${get('nome')}\n`;
      t += `Telefone: ${get('telefone')}\n`;
      t += `E-mail: ${get('email')}\n`;
      t += `Tipo de evento: ${get('tipo_evento')}\n\n`;
      t += `Buffet: ${get('buffet')}\n`;
      t += `Tipos de buffet: ${j(data.tipo_buffet)}\n`;
      t += `Prefer√™ncias do buffet: ${get('buffet_custom')}\n\n`;
      t += `Audiovisual: ${get('aud')}\n`;
      t += `Tipos de audiovisual: ${j(data.tipo_aud)}\n\n`;
      t += `RH: ${get('rh')}\n`;
      t += `Cargos solicitados: ${j(data.tipo_rh)}\n\n`;
      t += `Cerimonial: ${get('cerim')}\n`;
      t += `Observa√ß√µes: ${get('obs')}\n`;
      return t;
    }

    function downloadTxt(filename, content){
      const blob = new Blob([content], {type: 'text/plain;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    async function sendToWebhook(data){
      // tentar CORS normal
      try{
        const res = await fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(data),
          mode: 'cors',
        });
        // se Apps Script retornar JSON { ok, folderUrl, fileUrl }, usamos:
        const maybeJson = await res.json().catch(()=>null);
        return maybeJson || { ok: res.ok };
      }catch(err){
        return { ok:false, error: String(err) };
      }
    }

    // fallback por <form> oculto (√∫til se o ambiente travar CORS)
    function postViaHiddenForm(json){
      const form = document.createElement('form');
      form.action = WEBHOOK_URL;
      form.method = 'POST';
      form.target = '_hidden_iframe';
      form.style.display = 'none';

      const input = document.createElement('input');
      input.type = 'hidden';
      input.name = 'payload';               // no Apps Script, pegue em e.parameter.payload e JSON.parse
      input.value = JSON.stringify(json);
      form.appendChild(input);

      let iframe = document.getElementById('_hidden_iframe');
      if (!iframe){
        iframe = document.createElement('iframe');
        iframe.name = '_hidden_iframe';
        iframe.id = '_hidden_iframe';
        iframe.style.display='none';
        document.body.appendChild(iframe);
      }
      document.body.appendChild(form);
      form.submit();
    }

    function setLoading(isLoading){
      const btns = [prevBtn, nextBtn, sendBtn];
      btns.forEach(b => b && (b.disabled = isLoading));
      if (isLoading){
        sendBtn?.classList.add('tw-opacity-60','tw-cursor-not-allowed');
        sendBtn && (sendBtn.textContent = 'Enviando‚Ä¶');
      } else {
        sendBtn?.classList.remove('tw-opacity-60','tw-cursor-not-allowed');
        sendBtn && (sendBtn.textContent = 'Enviar');
      }
    }

    function showStatus(ok, msg, extraHtml=''){
      statusBox.className = 'tw-mt-6 tw-text-center';
      statusBox.classList.add(ok ? 'tw-text-emerald-700' : 'tw-text-red-600');
      statusBox.innerHTML = `<div class="tw-font-semibold">${msg}</div>${extraHtml}`;
      statusBox.classList.remove('tw-hidden');
    }

    /******** SUBMIT ********/
    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      buildResume();

      const data = formToObject();
      localStorage.setItem('chicas:last_briefing', JSON.stringify(data));

      const text = buildSummaryText(data);
      downloadTxt(`briefing-${Date.now()}.txt`, text);

      setLoading(true);
      let result = await sendToWebhook(data);

      // se falhou, tenta fallback por form oculto
      if (!result.ok){
        try{
          postViaHiddenForm({ ...data, _compat: true });
          // damos feedback otimista no fallback
          result = { ok:true };
        }catch(e){
          setLoading(false);
          showStatus(false, 'N√£o foi poss√≠vel enviar agora. Tente novamente em alguns instantes.');
          return;
        }
      }

      setLoading(false);

      // Se tiver links de retorno do Apps Script, mostramos; se n√£o, s√≥ confirma.
      if (result.folderUrl || result.fileUrl){
        const links = `
          <div class="tw-mt-2 tw-text-sm">
            ${result.folderUrl ? `<a class="tw-underline" href="${result.folderUrl}" target="_blank" rel="noopener">Abrir pasta do cliente</a>` : ''}
            ${result.fileUrl ? ` ¬∑ <a class="tw-underline" href="${result.fileUrl}" target="_blank" rel="noopener">Ver briefing no Drive</a>` : ''}
          </div>`;
        showStatus(true, 'Briefing enviado! Nossa equipe j√° recebeu üëç', links);
      } else {
        showStatus(true, 'Briefing enviado! Nossa equipe j√° recebeu üëç');
      }

      // opcional: levar o usu√°rio pro topo
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    /******** INIT ********/
    updateUI();
  </script>
</body>
</html>
